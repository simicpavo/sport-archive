<div class="competitions-form mx-auto max-w-screen-lg p-4">
  <div class="mx-auto max-w-md">
    <!-- Header -->
    <div class="mb-6 text-center">
      <h2 class="text-900 m-0 text-3xl font-bold">
        {{ this.isEditMode() ? 'Edit Competition' : 'Create New Competition' }}
      </h2>
      <p class="text-color-secondary mt-2 text-lg">
        {{
          isEditMode() ? 'Update competition information' : 'Add a new competition to the system'
        }}
      </p>
    </div>

    <!-- Loading Spinner -->
    @if (isLoading()) {
      <app-loading-spinner />
    }

    <!-- Form Card -->
    <p-card [class.opacity-50]="isLoading()">
      <ng-template pTemplate="content">
        <form [formGroup]="competitionForm" (ngSubmit)="onSubmit()">
          <div class="field mb-4">
            <label class="mb-2 block font-medium" for="name"> Competition Name </label>
            <input
              class="w-full"
              formControlName="name"
              id="name"
              pInputText
              placeholder="Enter competition name (e.g., Premier League)"
              type="text"
            />

            @if (
              competitionForm.get('name')?.hasError('required') &&
              competitionForm.get('name')?.dirty &&
              competitionForm.get('name')?.invalid
            ) {
              <span
                class="mt-4 block rounded-md border-l-4 border-l-[#dc3545] bg-[rgb(220,53,69)]/10 px-4 py-3 font-medium text-red-500"
              >
                This field is required!
              </span>
            }

            @if (
              competitionForm.get('name')?.hasError('minlength') &&
              competitionForm.get('name')?.dirty &&
              competitionForm.get('name')?.invalid
            ) {
              <span
                class="mt-4 block rounded-md border-l-4 border-l-[#dc3545] bg-[rgb(220,53,69)]/10 px-4 py-3 font-medium text-red-500"
              >
                Name must be at least 2 characters long.
              </span>
            }

            <label class="mt-2 mb-2 block font-medium" for="season"> Competition Season </label>
            <input
              class="w-full"
              formControlName="season"
              id="season"
              pInputText
              placeholder="Enter competition season (e.g., 2023/2024)"
              type="text"
            />
            <label class="mt-2 mb-2 block font-medium" for="sportId"> Sport </label>
            <p-select
              class="w-full"
              formControlName="sportId"
              optionLabel="name"
              optionValue="id"
              placeholder="Select Sport"
              [loading]="isLoading()"
              [options]="sports() || []"
              [showClear]="true"
            />

            @if (
              competitionForm.get('sportId')?.hasError('required') &&
              competitionForm.get('sportId')?.dirty &&
              competitionForm.get('sportId')?.invalid
            ) {
              <span
                class="mt-4 block rounded-md border-l-4 border-l-[#dc3545] bg-[rgb(220,53,69)]/10 px-4 py-3 font-medium text-red-500"
              >
                This field is required!
              </span>
            }

            <label class="mt-2 mb-2 block font-medium" for="startDate"> Start Date </label>
            <p-datePicker
              class="w-full"
              dateFormat="yy.mm.dd"
              formControlName="startDate"
              hourFormat="24"
              id="startDate"
              placeholder="Enter start date"
              [showIcon]="true"
            />

            <label class="mt-2 mb-2 block font-medium" for="endDate"> End Date </label>
            <p-datePicker
              class="w-full"
              dateFormat="yy.mm.dd"
              formControlName="endDate"
              hourFormat="24"
              id="endDate"
              placeholder="Enter end date"
              [showIcon]="true"
            />
          </div>

          <!-- Action Buttons -->
          <div class="justify-content-end flex gap-2 pt-4">
            <p-button
              label="Cancel"
              severity="secondary"
              type="button"
              [disabled]="isLoading()"
              [outlined]="true"
              (onClick)="navigateToCompetitionsList()"
            />

            <p-button
              icon="pi pi-check"
              type="submit"
              [disabled]="
                competitionForm.invalid ||
                (isEditMode() &&
                  competitionForm.controls.name.dirty === false &&
                  competitionForm.controls.season.dirty === false &&
                  competitionForm.controls.startDate.dirty === false &&
                  competitionForm.controls.endDate.dirty === false &&
                  competitionForm.controls.sportId.dirty === false)
              "
              [label]="this.isEditMode() ? 'Update Competition' : 'Create Competition'"
              [loading]="isLoading()"
            />
          </div>
        </form>
      </ng-template>
    </p-card>
  </div>
</div>

<p-toast />
