<div class="persons-form p-4 max-w-screen-lg mx-auto">
  <div class="max-w-md mx-auto">
    <!-- Header -->
    <div class="mb-6 text-center">
      <h2 class="text-3xl font-bold m-0 text-900">
        {{ this.isEditMode() ? 'Edit Person' : 'Create New Person' }}
      </h2>
      <p class="text-color-secondary mt-2 text-lg">
        {{ isEditMode() ? 'Update person information' : 'Add a new person to the system' }}
      </p>
    </div>

    <!-- Loading Spinner -->
    @if (isLoading()) {
      <app-loading-spinner />
    }

    <!-- Form Card -->
    <p-card [class.opacity-50]="isLoading()">
      <ng-template pTemplate="content">
        <form [formGroup]="personForm" (ngSubmit)="onSubmit()">
          <div class="field mb-4">
            <label class="block font-medium mb-2" for="firstName"> First Name </label>
            <input
              autocomplete="off"
              class="w-full"
              formControlName="firstName"
              id="firstName"
              pInputText
              placeholder="Enter first name"
              type="text"
            />
            @if (
              personForm.get('firstName')?.hasError('required') &&
              personForm.get('firstName')?.dirty &&
              personForm.get('firstName')?.invalid
            ) {
              <span
                class="mt-4 rounded-md py-3 px-4 block text-red-500 font-medium bg-[rgb(220,53,69)]/10 border-l-4 border-l-[#dc3545]"
              >
                This field is required!
              </span>
            }
            <label class="block font-medium mb-2 mt-2" for="lastName"> Last Name </label>
            <input
              autocomplete="off"
              class="w-full"
              formControlName="lastName"
              id="lastName"
              pInputText
              placeholder="Enter last name"
              type="text"
            />
            @if (
              personForm.get('lastName')?.hasError('required') &&
              personForm.get('lastName')?.dirty &&
              personForm.get('lastName')?.invalid
            ) {
              <span
                class="mt-4 rounded-md py-3 px-4 block text-red-500 font-medium bg-[rgb(220,53,69)]/10 border-l-4 border-l-[#dc3545]"
              >
                This field is required!
              </span>
            }
            <label class="block font-medium mb-2 mt-2" for="nickname"> Nickname </label>
            <input
              autocomplete="off"
              class="w-full"
              formControlName="nickname"
              id="nickname"
              pInputText
              placeholder="Enter nickname"
              type="text"
            />
            <label class="block font-medium mb-2 mt-2" for="nationality"> Nationality </label>
            <input
              autocomplete="off"
              class="w-full"
              formControlName="nationality"
              id="nationality"
              pInputText
              placeholder="Enter nationality"
              type="text"
            />
            @if (
              personForm.get('nationality')?.hasError('required') &&
              personForm.get('nationality')?.dirty &&
              personForm.get('nationality')?.invalid
            ) {
              <span
                class="mt-4 rounded-md py-3 px-4 block text-red-500 font-medium bg-[rgb(220,53,69)]/10 border-l-4 border-l-[#dc3545]"
              >
                This field is required!
              </span>
            }
            <label class="block font-medium mb-2 mt-2" for="birthDate"> Birth Date </label>
            <p-datePicker
              autocomplete="off"
              class="w-full"
              formControlName="birthDate"
              id="birthDate"
              placeholder="Enter birth date"
              type="date"
            />
            @if (
              personForm.get('nickname')?.hasError('required') &&
              personForm.get('nickname')?.dirty &&
              personForm.get('nickname')?.invalid
            ) {
              <span
                class="mt-4 rounded-md py-3 px-4 block text-red-500 font-medium bg-[rgb(220,53,69)]/10 border-l-4 border-l-[#dc3545]"
              >
                This field is required!
              </span>
            }
          </div>

          <!-- Action Buttons -->
          <div class="flex gap-2 justify-content-end pt-4">
            <p-button
              label="Cancel"
              severity="secondary"
              type="button"
              [disabled]="isLoading()"
              [outlined]="true"
              (onClick)="navigateToPersonsList()"
            />

            <p-button
              icon="pi pi-check"
              type="submit"
              [disabled]="
                personForm.invalid ||
                (isEditMode() &&
                  personForm.controls.firstName.dirty === false &&
                  personForm.controls.lastName.dirty === false &&
                  personForm.controls.nickname.dirty === false &&
                  personForm.controls.birthDate.dirty === false &&
                  personForm.controls.nationality.dirty === false)
              "
              [label]="this.isEditMode() ? 'Update Person' : 'Create Person'"
              [loading]="isLoading()"
            />
          </div>
        </form>
      </ng-template>
    </p-card>
  </div>
</div>

<p-toast />
