<!-- Main container -->
<div class="min-h-screen bg-gray-900 text-white p-6">
  <!-- Header and filter section -->
  <div class="max-w-4xl mx-auto mb-8">
    <h1 class="text-2xl font-bold text-center mb-6">Latest Sports News</h1>

    <div class="flex justify-center gap-2">
      @for (filter of timeFilters; track filter.value) {
        <button
          class="px-4 py-2 rounded font-medium transition-colors"
          [class.bg-teal-500]="selectedFilter() === filter.value"
          [class.text-white]="selectedFilter() === filter.value"
          [class.bg-gray-700]="selectedFilter() !== filter.value"
          [class.text-gray-300]="selectedFilter() !== filter.value"
          [class.hover:bg-gray-600]="selectedFilter() !== filter.value"
          (click)="onTimeFilterChange(filter.value)"
        >
          {{ filter.label }}
        </button>
      }
    </div>
  </div>

  <!-- Error state -->
  @if (error()) {
    <div class="max-w-4xl mx-auto mb-6">
      <div class="bg-red-900/50 border border-red-700 rounded-lg p-4 text-red-200">
        <div class="flex items-center gap-2">
          <i class="pi pi-exclamation-triangle text-red-400"></i>
          <span>Failed to load news. Please try again.</span>
        </div>
      </div>
    </div>
  }

  <!-- Loading skeletons -->
  @if (loading()) {
    <div class="max-w-4xl mx-auto space-y-4">
      @for (item of [1, 2, 3, 4, 5]; track item) {
        <div class="bg-gray-800 rounded-lg p-6">
          <div class="flex items-center gap-3 mb-4">
            <p-skeleton shape="circle" size="40px"></p-skeleton>
            <div>
              <p-skeleton height="1rem" width="8rem" class="mb-2"></p-skeleton>
              <p-skeleton height="0.8rem" width="6rem"></p-skeleton>
            </div>
          </div>
          <p-skeleton height="1.5rem" width="90%" class="mb-3"></p-skeleton>
          <p-skeleton height="1rem" width="100%" class="mb-2"></p-skeleton>
          <p-skeleton height="1rem" width="80%"></p-skeleton>
        </div>
      }
    </div>
  }

  <!-- News list -->
  @if (!loading() && displayNews().length > 0) {
    <div class="max-w-4xl mx-auto space-y-6">
      @for (newsItem of displayNews(); track newsItem.id) {
        <article class="bg-gray-800 rounded-lg p-6 hover:bg-gray-750 transition-colors">
          <!-- Article header -->
          <div class="flex items-center gap-3 mb-4">
            @if (newsItem.mediaSource) {
              <div class="w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center">
                @if (newsItem.mediaSource.logoUrl) {
                  <img
                    [src]="newsItem.mediaSource.logoUrl"
                    [alt]="newsItem.mediaSource.name"
                    class="w-full h-full object-cover rounded-full"
                  />
                } @else {
                  <i class="pi pi-globe text-gray-400"></i>
                }
              </div>
              <div>
                <h4 class="text-white font-medium">{{ newsItem.mediaSource.name }}</h4>
              </div>
            } @else {
              <div class="w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center">
                <i class="pi pi-newspaper text-gray-400"></i>
              </div>
              <div>
                <h4 class="text-white font-medium">Sports News</h4>
                <p class="text-gray-400 text-sm">{{ formatDate(newsItem.createdAt) }}</p>
              </div>
            }
          </div>

          <!-- Article content -->
          <h3 class="text-xl font-semibold text-white mb-3 leading-tight">
            {{ newsItem.title }}
          </h3>

          <p class="text-gray-300 leading-relaxed mb-4">
            {{ newsItem.content }}
          </p>

          <!-- Engagement stats -->
          <div class="flex items-center gap-6 mb-4 text-sm text-gray-400">
            <div class="flex items-center gap-1">
              <span class="text-red-400">‚ù§Ô∏è</span>
              <span>{{ formatEngagements(newsItem.likeCount || 0) }}</span>
            </div>
            <div class="flex items-center gap-1">
              <span class="text-blue-400">üí¨</span>
              <span>{{ formatEngagements(newsItem.commentCount || 0) }}</span>
            </div>
            <div class="flex items-center gap-1">
              <span class="text-green-400">üîÑ</span>
              <span>{{ formatEngagements(newsItem.shareCount || 0) }}</span>
            </div>
            <div class="flex items-center gap-1">
              <span class="text-purple-400">üë•</span>
              <span>{{ formatEngagements(newsItem.totalEngagements || 0) }} total</span>
            </div>
          </div>

          <!-- Read Article button -->
          <div class="flex justify-between items-center">
            <div class="text-sm text-gray-500">{{ formatDate(newsItem.createdAt) }}</div>
            <button
              class="bg-teal-500 hover:bg-teal-600 text-white text-sm font-medium py-2 px-4 rounded transition-colors"
              (click)="onReadMore($event, newsItem)"
              type="button"
            >
              Read Article
            </button>
          </div>
        </article>
      }
    </div>
  }

  <!-- Load more trigger - Only show when there's actually more to load -->
  @if (!loading() && hasMore() && displayNews().length > 0) {
    <div id="scroll-trigger" class="py-6">
      @if (loadingMore()) {
        <div class="max-w-4xl mx-auto">
          <div class="bg-gray-800 rounded-lg p-6">
            <div class="flex items-center justify-center gap-3 text-gray-400">
              <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-teal-500"></div>
              <span>Loading more news...</span>
            </div>
          </div>
        </div>
      }
    </div>
  }

  <!-- End of content message -->
  @if (!loading() && !hasMore() && displayNews().length > 0) {
    <div class="my-12 text-center">
      <div class="text-gray-500">üéØ You've reached the end! That's all the news for now.</div>
      @if (total() > 0) {
        <div class="text-sm text-gray-600 mt-2">
          Showing {{ displayNews().length }} of {{ total() }} articles
        </div>
      }
    </div>
  }

  <!-- Empty state -->
  @if (!loading() && displayNews().length === 0) {
    <div class="max-w-4xl mx-auto text-center py-12">
      <div class="bg-gray-800 rounded-lg p-12">
        <div class="text-6xl mb-4">üì≠</div>
        <h3 class="text-xl font-semibold text-white mb-4">No news found</h3>
        <p class="text-gray-400 mb-6">
          It seems like there's no sports news available for the selected time period. Try adjusting
          your filter or check back later for fresh content!
        </p>
        <button
          class="bg-teal-500 hover:bg-teal-600 text-white font-medium py-2 px-4 rounded transition-colors"
          (click)="loadInitialNews()"
          [disabled]="loading()"
        >
          @if (loading()) {
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div>
          }
          üîÑ Refresh
        </button>
      </div>
    </div>
  }
</div>
